<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
  <title>Buscador</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
  <script src="https://code.jquery.com/jquery-3.1.0.min.js"
    integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
  <link rel="stylesheet" href="css/ion.rangeSlider.css">
  <link rel="stylesheet" href="css/ion.rangeSlider.skinFlat.css">
  <script src="js/ion.rangeSlider.min.js"></script>
  <link rel="stylesheet" href="css/app.css">
</head>

<body>

  <div class="navbar-fixed">
    <nav>
      <div class="blue darken-3 nav-wrapper center-align">
        <h4>Buscador de Propiedades</h4>
      </div>
    </nav>
  </div>
  <div class="row">
    <div class="col m4">
      <div class="card horizontal">
        <div class="container center-align">
          <div class="switch">
            <h5>Busqueda Personalizada: </h5>
            <label>
              Desactivada
              <input type="checkbox" id="checkPersonalizada">
              <span class="lever"></span>
              Activada
            </label>
          </div>
          <!--  Busqueda personalizada -->         
          <form name="formbuscar" id="formbuscar" action="/" method="POST" target="request">
            <div class="row invisible" id="personalizada">
              <div class="row">
                <label for="ciudad">Ciudad:</label>
                <select name="selectciudad" id="selectciudad" >
                  <option value="">Escoge una ciudad</option>
                  <% for (var i = 0; i < ciudades.length; i++) { %>
                  <option value="<%= ciudades[i] %>"><%= ciudades[i] %></option>
                  <% } %>
                </select>
              </div>
              <div class="row">
                <label for="tipo">Tipo:</label>
                <select  name="selecttipo" id="selecttipo" >
                  <option value="">Escoge un tipo</option>
                  <% for (var i = 0; i < tipos.length; i++) { %>
                  <option value="<%= tipos[i] %>"><%= tipos[i] %></option>
                  <% } %>
                </select>
              </div>
              <div class="row">
                <label for="rangoPrecio">Precio:</label>
                <input type="text" id="rangoPrecio" onchange="ShowSelected()">
              </div>
            </div>
            <button id="buscar" class="btn waves-effect waves-light blue" type="button" onclick="mostrartodos()">Ver
              Todos</button>
          </form>
        </div>
      </div>
    </div>

    <!--  %%%%%%%%%%  Debug para mostrar datos %%%%%%%%%%%  
    <div class="row">
      <div class="col m4">
        <div class="card horizontal">
          <div class="container center-align">
              <%=bodyciudad, bodytipo %>

          </div>
        </div>
      </div>
    </div>

      %%%%%%%%%%  Debug para mostrar datos %%%%%%%%%%%  -->

    <div id="proptodas" class="col m8 lista">
      <% if (datos) { %>
      <% for(var i = 0; i < datos.length; i++) { %>
      <div hidden class="card horizontal">
        <div class="card-image">
          <img src="img/home.jpg">
        </div>
        <div class="card-stacked">
          <div class="card-content">
            <div>
              <b>Direccion: </b><span id="dir<%= i %>"></span><%= datos[i].Direccion %></span>
              <p></p>
            </div>
            <div>
              <b>Ciudad: </b> <span id="ciu<%= i %>"> <%= datos[i].Ciudad %></span>
              <p></p>
            </div>
            <div>
              <b>Telefono: </b><span id="tel<%= i %>"></span><%= datos[i].Telefono %></span>
              <p></p>
            </div>
            <div>
              <b>C칩digo postal: </b><span id="zip<%= i %>"></span><%= datos[i].Codigo_postal %></span>
              <p></p>
            </div>
            <div>
              <b>Precio: </b><span id="pre<%= i %>"></span><%= datos[i].Precio %></span>
              <p></p>
            </div>
            <div>
              <b>Tipo: </b><span id="tip<%= i %>"> <%= datos[i].Tipo %></span>
              <p></p>
            </div>
          </div>
        </div>
        <div class="card-action right-align">
          <a href="#">Ver m치s</a>
        </div>
      </div>
      <% } %>
      <div hidden id="total">
        <%= i %>
      </div>
      <% } %>

    </div>

    <div id="propbusqueda" class="col m8 lista">
      <div id="reemplaza">
        
        
        <% if (datos) { %>
        <% for(var i = 0; i < datos.length; i++) { %>
          <% if (datos[i].Ciudad == bodyciudad) { %>
        <div hidden class="card horizontal">
          <div class="card-image">
            <img src="img/home.jpg">
          </div>
          <div class="card-stacked">
            <div class="card-content">
              <div>
                <b>Direccion: </b><span id="dir<%= i %>"></span><%= datos[i].Direccion %></span>
                <p></p>
              </div>
              <div>
                <b>Ciudad: </b> <span id="ciu<%= i %>"> <%= datos[i].Ciudad %></span>
                <p></p>
              </div>
              <div>
                <b>Telefono: </b><span id="tel<%= i %>"></span><%= datos[i].Telefono %></span>
                <p></p>
              </div>
              <div>
                <b>C칩digo postal: </b><span id="zip<%= i %>"></span><%= datos[i].Codigo_postal %></span>
                <p></p>
              </div>
              <div>
                <b>Precio: </b><span id="pre<%= i %>"></span><%= datos[i].Precio %></span>
                <p></p>
              </div>
              <div>
                <b>Tipo: </b><span id="tip<%= i %>"> <%= datos[i].Tipo %></span>
                <p></p>
              </div>
            </div>
          </div>
          <div class="card-action right-align">
            <a href="#">Ver m치s</a>
          </div>
        </div>
        <% } %>
        <% } %>
        <div hidden id="total">
          <%= i %>
        </div>
        <% } %>
    
      </div>
    
    </div>
    
    </div>
  

  <div hidden id="var1">
    document.getElementbyId(var1).value
  </div>
  <div hidden id="var2">

  </div>


  <div hidden id="datosall">
      <% async function newjson() { %>
        <% var newjson = [] %>
        <% for await (var it of datos) { %>
          <% newjson[it.Id - 1] = it %>
          <% } %>          
          <% return newjson %>
          <% } newjson(); %>
          
    
  </div>



  <script src="js/app.js"></script>
</body>

</html>